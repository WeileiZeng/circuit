% Weilei Zeng
% A circuit to measure G_1
% 
%   qubit	   q0
%   qubit	   q1
%   qubit	   q2
%   qubit	   A0,0
%   qubit	   A1,0
%   qubit	   q3
%   qubit	   q4
%   qubit	   q5
%   qubit	   A2,0
%   qubit	   A3,0
%   qubit	   q6
%   qubit	   q7
%   qubit	   q8
%g1
%   nop	   q1
%   cnot	   q1,A0
% 
%   h        A1
% 
%   cnot     A1,q0
%   cnot     A1,q1
% 
%   cnot	   q2,A0
%   cnot	   q0,A0
%   cnot     A1,q2
% 
%   nop	   q4
%   cnot	   q4,A2
% 
%   h        A3
%  cnot     A3,q5
%   cnot     A3,q3
%   cnot     A3,q4
% 
%   cnot	   q5,A2
%   cnot	   q3,A2
%   cnot     A3,q5
% 
%g2
%   cnot	   q3,A0
% 
%   cnot     A1,q4
%   cnot     A1,q3
%   h        A1
% 
% 
%   h	   q4
% 
%   h	   q5
%   cnot	   q5,A0
%   h	   q5
%   cnot	   q4,A0
%   h	   q4
% 
% 
%   cnot	   q5,A1
%   cnot	   q4,A1
% 
%   cnot	   q5,A0
%   cnot	   q6,A2
% 
% 
%   cnot	   A3,q7
%   cnot	   A3,q6
%   h	   A3
% 
%   h	   q7
%   nop	   q8
%   nop	   q8
%   nop	   q8
%   nop	   q8
%   h	   q8
%   cnot	   q8,A2
%   h	   q8
%   cnot	   q7,A2
%   h	   q7
% 
%   cnot	   q8,A3
%   cnot	   q7,A3
%   cnot	   q8,A2
% 
%   measure  A0
%   measure  A1
%   measure  A2
%   measure  A3
%  Time 01:
%    Gate 00 nop(q1)
%    Gate 02 h(A1)
%    Gate 08 nop(q4)
%    Gate 10 h(A3)
%    Gate 34 nop(q8)
%  Time 02:
%    Gate 01 cnot(q1,A0)
%    Gate 03 cnot(A1,q0)
%    Gate 09 cnot(q4,A2)
%    Gate 11 cnot(A3,q3)
%    Gate 35 nop(q8)
%  Time 03:
%    Gate 04 cnot(A1,q1)
%    Gate 05 cnot(q2,A0)
%    Gate 12 cnot(A3,q4)
%    Gate 13 cnot(q5,A2)
%    Gate 36 nop(q8)
%  Time 04:
%    Gate 06 cnot(q0,A0)
%    Gate 07 cnot(A1,q2)
%    Gate 14 cnot(q3,A2)
%    Gate 15 cnot(A3,q5)
%    Gate 37 nop(q8)
%  Time 05:
%    Gate 16 cnot(q3,A0)
%    Gate 17 cnot(A1,q4)
%    Gate 21 h(q5)
%    Gate 29 cnot(q6,A2)
%    Gate 30 cnot(A3,q7)
%    Gate 38 h(q8)
%  Time 06:
%    Gate 18 cnot(A1,q3)
%    Gate 20 h(q4)
%    Gate 22 cnot(q5,A0)
%    Gate 31 cnot(A3,q6)
%    Gate 33 h(q7)
%    Gate 39 cnot(q8,A2)
%  Time 07:
%    Gate 19 h(A1)
%    Gate 23 h(q5)
%    Gate 24 cnot(q4,A0)
%    Gate 32 h(A3)
%    Gate 40 h(q8)
%    Gate 41 cnot(q7,A2)
%  Time 08:
%    Gate 25 h(q4)
%    Gate 26 cnot(q5,A1)
%    Gate 42 h(q7)
%    Gate 43 cnot(q8,A3)
%  Time 09:
%    Gate 27 cnot(q4,A1)
%    Gate 28 cnot(q5,A0)
%    Gate 44 cnot(q7,A3)
%    Gate 45 cnot(q8,A2)
%  Time 10:
%    Gate 46 measure(A0)
%    Gate 47 measure(A1)
%    Gate 48 measure(A2)
%    Gate 49 measure(A3)

% Qubit circuit matrix:
%
% q0: n  , gBxA, n  , gDxA, n  , n  , n  , n  , n  , n  , n  
% q1: gAxB, gBxB, gCxB, n  , n  , n  , n  , n  , n  , n  , n  
% q2: n  , n  , gCxC, gDxC, n  , n  , n  , n  , n  , n  , n  
% A0: n  , gBxD, gCxD, gDxD, gExD, gFxD, gGxD, n  , gIxD, gJxD, N  
% A1: gAxE, gBxE, gCxE, gDxE, gExE, gFxE, gGxE, gHxE, gIxE, gJxE, N  
% q3: n  , gBxF, n  , gDxF, gExF, gFxF, n  , n  , n  , n  , n  
% q4: gAxG, gBxG, gCxG, n  , gExG, gFxG, gGxG, gHxG, gIxG, n  , n  
% q5: n  , n  , gCxH, gDxH, gExH, gFxH, gGxH, gHxH, gIxH, n  , n  
% A2: n  , gBxI, gCxI, gDxI, gExI, gFxI, gGxI, n  , gIxI, gJxI, N  
% A3: gAxJ, gBxJ, gCxJ, gDxJ, gExJ, gFxJ, gGxJ, gHxJ, gIxJ, gJxJ, N  
% q6: n  , n  , n  , n  , gExK, gFxK, n  , n  , n  , n  , n  
% q7: n  , n  , n  , n  , gExL, gFxL, gGxL, gHxL, gIxL, n  , n  
% q8: gAxM, gBxM, gCxM, gDxM, gExM, gFxM, gGxM, gHxM, gIxM, n  , n  

\documentclass[11pt]{article}
\input{xyqcirc.tex}

% definitions for the circuit elements

\def\gAxB{*-{}\w\A{gAxB}}
\def\gBxB{\b\w\A{gBxB}}
\def\gBxD{\o\w\A{gBxD}}
\def\gAxE{\op{H}\w\A{gAxE}}
\def\gBxE{\b\w\A{gBxE}}
\def\gBxA{\o\w\A{gBxA}}
\def\gCxE{\b\w\A{gCxE}}
\def\gCxB{\o\w\A{gCxB}}
\def\gCxC{\b\w\A{gCxC}}
\def\gCxD{\o\w\A{gCxD}}
\def\gDxA{\b\w\A{gDxA}}
\def\gDxD{\o\w\A{gDxD}}
\def\gDxE{\b\w\A{gDxE}}
\def\gDxC{\o\w\A{gDxC}}
\def\gAxG{*-{}\w\A{gAxG}}
\def\gBxG{\b\w\A{gBxG}}
\def\gBxI{\o\w\A{gBxI}}
\def\gAxJ{\op{H}\w\A{gAxJ}}
\def\gBxJ{\b\w\A{gBxJ}}
\def\gBxF{\o\w\A{gBxF}}
\def\gCxJ{\b\w\A{gCxJ}}
\def\gCxG{\o\w\A{gCxG}}
\def\gCxH{\b\w\A{gCxH}}
\def\gCxI{\o\w\A{gCxI}}
\def\gDxF{\b\w\A{gDxF}}
\def\gDxI{\o\w\A{gDxI}}
\def\gDxJ{\b\w\A{gDxJ}}
\def\gDxH{\o\w\A{gDxH}}
\def\gExF{\b\w\A{gExF}}
\def\gExD{\o\w\A{gExD}}
\def\gExE{\b\w\A{gExE}}
\def\gExG{\o\w\A{gExG}}
\def\gFxE{\b\w\A{gFxE}}
\def\gFxF{\o\w\A{gFxF}}
\def\gGxE{\op{H}\w\A{gGxE}}
\def\gFxG{\op{H}\w\A{gFxG}}
\def\gExH{\op{H}\w\A{gExH}}
\def\gFxH{\b\w\A{gFxH}}
\def\gFxD{\o\w\A{gFxD}}
\def\gGxH{\op{H}\w\A{gGxH}}
\def\gGxG{\b\w\A{gGxG}}
\def\gGxD{\o\w\A{gGxD}}
\def\gHxG{\op{H}\w\A{gHxG}}
\def\gHxH{\b\w\A{gHxH}}
\def\gHxE{\o\w\A{gHxE}}
\def\gIxG{\b\w\A{gIxG}}
\def\gIxE{\o\w\A{gIxE}}
\def\gIxH{\b\w\A{gIxH}}
\def\gIxD{\o\w\A{gIxD}}
\def\gExK{\b\w\A{gExK}}
\def\gExI{\o\w\A{gExI}}
\def\gExJ{\b\w\A{gExJ}}
\def\gExL{\o\w\A{gExL}}
\def\gFxJ{\b\w\A{gFxJ}}
\def\gFxK{\o\w\A{gFxK}}
\def\gGxJ{\op{H}\w\A{gGxJ}}
\def\gFxL{\op{H}\w\A{gFxL}}
\def\gAxM{*-{}\w\A{gAxM}}
\def\gBxM{*-{}\w\A{gBxM}}
\def\gCxM{*-{}\w\A{gCxM}}
\def\gDxM{*-{}\w\A{gDxM}}
\def\gExM{\op{H}\w\A{gExM}}
\def\gFxM{\b\w\A{gFxM}}
\def\gFxI{\o\w\A{gFxI}}
\def\gGxM{\op{H}\w\A{gGxM}}
\def\gGxL{\b\w\A{gGxL}}
\def\gGxI{\o\w\A{gGxI}}
\def\gHxL{\op{H}\w\A{gHxL}}
\def\gHxM{\b\w\A{gHxM}}
\def\gHxJ{\o\w\A{gHxJ}}
\def\gIxL{\b\w\A{gIxL}}
\def\gIxJ{\o\w\A{gIxJ}}
\def\gIxM{\b\w\A{gIxM}}
\def\gIxI{\o\w\A{gIxI}}
\def\gJxD{\meter\w\A{gJxD}}
\def\gJxE{\meter\w\A{gJxE}}
\def\gJxI{\meter\w\A{gJxI}}
\def\gJxJ{\meter\w\A{gJxJ}}

% definitions for bit labels and initial states

\def\bA{ \q{q_{0}}}
\def\bB{ \q{q_{1}}}
\def\bC{ \q{q_{2}}}
\def\bD{\qv{A_{0}}{0}}
\def\bE{\qv{A_{1}}{0}}
\def\bF{ \q{q_{3}}}
\def\bG{ \q{q_{4}}}
\def\bH{ \q{q_{5}}}
\def\bI{\qv{A_{2}}{0}}
\def\bJ{\qv{A_{3}}{0}}
\def\bK{ \q{q_{6}}}
\def\bL{ \q{q_{7}}}
\def\bM{ \q{q_{8}}}

% The quantum circuit as an xymatrix

\xymatrix@R=5pt@C=10pt{
    \bA & \n   &\gBxA &\n   &\gDxA &\n   &\n   &\n   &\n   &\n   &\n   &\n  
\\  \bB & \gAxB &\gBxB &\gCxB &\n   &\n   &\n   &\n   &\n   &\n   &\n   &\n  
\\  \bC & \n   &\n   &\gCxC &\gDxC &\n   &\n   &\n   &\n   &\n   &\n   &\n  
\\  \bD & \n   &\gBxD &\gCxD &\gDxD &\gExD &\gFxD &\gGxD &\n   &\gIxD &\gJxD &\N  
\\  \bE & \gAxE &\gBxE &\gCxE &\gDxE &\gExE &\gFxE &\gGxE &\gHxE &\gIxE &\gJxE &\N  
\\  \bF & \n   &\gBxF &\n   &\gDxF &\gExF &\gFxF &\n   &\n   &\n   &\n   &\n  
\\  \bG & \gAxG &\gBxG &\gCxG &\n   &\gExG &\gFxG &\gGxG &\gHxG &\gIxG &\n   &\n  
\\  \bH & \n   &\n   &\gCxH &\gDxH &\gExH &\gFxH &\gGxH &\gHxH &\gIxH &\n   &\n  
\\  \bI & \n   &\gBxI &\gCxI &\gDxI &\gExI &\gFxI &\gGxI &\n   &\gIxI &\gJxI &\N  
\\  \bJ & \gAxJ &\gBxJ &\gCxJ &\gDxJ &\gExJ &\gFxJ &\gGxJ &\gHxJ &\gIxJ &\gJxJ &\N  
\\  \bK & \n   &\n   &\n   &\n   &\gExK &\gFxK &\n   &\n   &\n   &\n   &\n  
\\  \bL & \n   &\n   &\n   &\n   &\gExL &\gFxL &\gGxL &\gHxL &\gIxL &\n   &\n  
\\  \bM & \gAxM &\gBxM &\gCxM &\gDxM &\gExM &\gFxM &\gGxM &\gHxM &\gIxM &\n   &\n  
%
% Vertical lines and other post-xymatrix latex
%
\ar@{-}"gBxD";"gBxB"
\ar@{-}"gBxA";"gBxE"
\ar@{-}"gCxB";"gCxE"
\ar@{-}"gCxD";"gCxC"
\ar@{-}"gDxD";"gDxA"
\ar@{-}"gDxC";"gDxE"
\ar@{-}"gBxI";"gBxG"
\ar@{-}"gBxF";"gBxJ"
\ar@{-}"gCxG";"gCxJ"
\ar@{-}"gCxI";"gCxH"
\ar@{-}"gDxI";"gDxF"
\ar@{-}"gDxH";"gDxJ"
\ar@{-}"gExD";"gExF"
\ar@{-}"gExG";"gExE"
\ar@{-}"gFxF";"gFxE"
\ar@{-}"gFxD";"gFxH"
\ar@{-}"gGxD";"gGxG"
\ar@{-}"gHxE";"gHxH"
\ar@{-}"gIxE";"gIxG"
\ar@{-}"gIxD";"gIxH"
\ar@{-}"gExI";"gExK"
\ar@{-}"gExL";"gExJ"
\ar@{-}"gFxK";"gFxJ"
\ar@{-}"gFxI";"gFxM"
\ar@{-}"gGxI";"gGxL"
\ar@{-}"gHxJ";"gHxM"
\ar@{-}"gIxJ";"gIxL"
\ar@{-}"gIxI";"gIxM"
}

\end{document}
